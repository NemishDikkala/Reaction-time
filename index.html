<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reaction Time Game</title>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            font-family: Arial, sans-serif;
            background-color: #f0f0f0;
            text-align: center;
        }
        #game-area {
            position: relative;
            height: 400px;
            width: 400px;
            margin: 20px auto;
            border: 1px solid black;
            background-color: #FFFFFF;
            overflow: hidden;
        }
        .circle {
            border-radius: 50%;
            position: absolute;
        }
        #stationary-circle {
            width: 50px;
            height: 50px;
            background-color: black;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
        }
        #moving-circle {
            width: 60px;
            height: 60px;
            border: 5px solid black;
            left: 50%;
            top: 0%;
            transform: translateX(-50%);
        }
        #controls {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 20px;
        }
        label, select, button {
            margin: 5px;
        }
        #results-table {
            margin-top: 20px;
            width: 80%;
            overflow-y: auto;
            max-height: 150px;
            border-collapse: collapse;
            margin-left: auto;
            margin-right: auto;
        }
        th, td {
            padding: 5px;
            text-align: left;
            border: 1px solid black;
        }
    </style>
</head>
<body>
    <div id="game-container">
        <h2>How to Play the Reaction Time Game</h2>
        <ul>
            <li>Press the space bar or tap the screen to start the game. The ring will begin moving towards the center.</li>
            <li>Press the space bar or tap the screen again when the ring aligns with the center circle to record your reaction time.</li>
            <li>Your reaction time and accuracy are shown after each attempt.</li>
            <li>Use the sliders to adjust the ring's speed, size, thickness, and color, as well as the center circle's size and color.</li>
            <li>Press 'Reset to Default' to return to the original settings at any time.</li>
        </ul>
        <div id="game-area">
            <div id="stationary-circle" class="circle"></div>
            <div id="moving-circle" class="circle"></div>
        </div>
        <div id="controls">
            <!-- Add your control elements here -->
        </div>
        <div id="results-table">
            <table id="reaction-times">
                <tr><th>#</th><th>Time (ms)</th><th>Accuracy (%)</th></tr>
            </table>
        </div>
        <div id="average-results"></div>
    </div>

    <script>
        let alignmentTime, endTime;
        let reactionTimes = [];
        let accuracies = [];
        let gameActive = false;
        const stationaryCircle = document.getElementById('stationary-circle');
        const movingCircle = document.getElementById('moving-circle');
        const centerY = stationaryCircle.offsetTop + stationaryCircle.offsetHeight / 2;
        const centerX = stationaryCircle.offsetLeft + stationaryCircle.offsetWidth / 2;

        function startGame() {
            movingCircle.style.display = 'block';
            resetCirclePosition();
            gameActive = true;
            alignmentTime = new Date().getTime() + 3000; // 3 seconds delay
            setTimeout(() => {
                moveCircle();
            }, 3000);
        }

        function resetCirclePosition() {
            movingCircle.style.top = '0px';
            movingCircle.style.left = '50%';
            movingCircle.style.transform = 'translateX(-50%)';
        }

        function moveCircle() {
            movingCircle.style.transition = 'top 2s linear, left 2s linear';
            movingCircle.style.top = (centerY - movingCircle.offsetHeight / 2) + 'px';
            movingCircle.style.left = centerX + 'px';
        }

        function recordReactionTime() {
            if (!gameActive) return;
            endTime = new Date().getTime();
            let reactionTime = Math.max(0, endTime - alignmentTime);
            let accuracy = 100 - Math.abs(centerY - movingCircle.offsetTop - movingCircle.offsetHeight / 2) / centerY * 100;
            reactionTimes.push(reactionTime);
            accuracies.push(accuracy);
            updateDisplay();
            resetGame();
        }

        function resetGame() {
            movingCircle.style.display = 'none';
            gameActive = false;
            resetCirclePosition();
        }

        function updateDisplay() {
            let tableHtml = '<tr><th>#</th><th>Time (ms)</th><th>Accuracy (%)</th></tr>';
            reactionTimes.forEach((time, index) => {
                tableHtml += `<tr><td>${index + 1}</td><td>${time}</td><td>${accuracies[index].toFixed(2)}%</td></tr>`;
            });
            document.getElementById('reaction-times').innerHTML = tableHtml;

            let averageTime = reactionTimes.reduce((a, b) => a + b, 0) / reactionTimes.length;
            let averageAccuracy = accuracies.reduce((a, b) => a + b, 0) / accuracies.length;
            document.getElementById('average-results').innerHTML = 'Average Time: ' + averageTime.toFixed(2) + ' ms, Average Accuracy: ' + averageAccuracy.toFixed(2) + '%';
        }

        // Event listener for both key press and touch event
        function handleInputEvent() {
            if (!gameActive) {
                startGame();
            } else {
                recordReactionTime();
            }
        }

        document.addEventListener('keydown', function(event) {
            if (event.code === 'Space') {
                handleInputEvent();
            }
        });

        document.addEventListener('touchstart', function(event) {
            handleInputEvent();
        }, { passive: true });

        // Reset to default settings on page load
        resetGame();
    </script>
</body>
</html>
